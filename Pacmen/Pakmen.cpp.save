//библиотека
#include "Books/TXlib.h"


struct Hero
    {
    int x,  y;
    int vx, vy;

    HDC photo;

    int UP, DOWN, LEFT, RIGHT, STOP;

    void Phisica  ();
    void KeyState ();
    void DrawHero ();
    void DeletDC  ();
    };
//------------------------------------------------------

int pakman ();
void DeletDC (HDC photo);
void Downloud (HDC* Fon, HDC* RIP);

const HDC fon    = NULL;
const HDC player = NULL;
//------------------------------------------------------

int main ()
    {
    txCreateWindow (1000, 1000);

    pakman ();
    }


int pakman ()
    {
    Hero Pacman {300, 50, 50, 25, player, 'W', 'S', 'A', 'D', 'Q'};

    txClear ();
    txTransparentBlt (txDC(), 0, 0, 1000, 1000, fon, 0, 0, TX_WHITE);

    Downloud (&fon , &player);

    while (!GetAsyncKeyState (VK_ESCAPE))
        {

        Pacman.DrawHero ();
        Pacman.Phisica  ();
        Pacman.KeyState ();

        txSleep (10);
        }

    DeletDC   (player);
    //txDeletDC (fon);
    }


void Hero::Phisica ()
    {
    x = x + vx;
    y = y + vy;

    if (x < 15)
        {
        vx = -vx;
        }

    if (y < 15)
        {
        vy = -vy;
        }

    if (x > 975)
        {
        vx = -vx;
        }

    if (y > 975)
        {
        vy = -vy;
        }

    }

void Hero::KeyState ()
    {
    if (GetAsyncKeyState (UP))    (vy)--;
    if (GetAsyncKeyState (DOWN))  (vy)++;
    if (GetAsyncKeyState (LEFT))  (vx)--;
    if (GetAsyncKeyState (RIGHT)) (vx)++;
    if (GetAsyncKeyState (STOP))  vx = vy = 0;
    }

void Hero::DrawHero ()
    {
    int xsize = txGetExtentX (photo);
    int ysize = txGetExtentY (photo);

    txTransparentBlt (txDC(), x, y, xsize, ysize, photo, 0, 0, TX_WHITE);
    }

void Hero::DeletDC ()
    {
    txDeleteDC (photo);
    }

void Downloud (HDC* Fon, HDC* RIP)
    {
    *Fon  = txLoadImage ("Image/play2/Fon.bmp");
    *RIP  = txLoadImage ("Image/play2/Pacman.bmp");
    }

